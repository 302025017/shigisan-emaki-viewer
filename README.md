# 信貴山縁起絵巻 鑑賞支援システム

国立国会図書館デジタルコレクションで公開されている『信貴山縁起絵巻』を鑑賞する初学者向けの質問入力型Webアプリケーションです。

## 特徴

- **シンプルな設計**: 質問と応答のみに特化
- **ローカル環境で完結**: 外部API不要、オフライン環境で動作可能
- **3場面対応**: 第4コマ、第7コマ、第17コマ
- **チャット形式UI**: 直感的で使いやすいインターフェース
- **完全一致判定**: 正確で予測可能な応答

## 動作環境

- Python 3.8以上
- Windows/Mac/Linux
- Webブラウザ（Chrome、Firefox、Safari、Edge など）

## インストール・実行手順

### 1. 依存パッケージのインストール

```bash
pip install -r requirements.txt
```

### 2. アプリケーションの実行

```bash
python Chat_bot.py
```

実行すると以下のメッセージが表示されます：

```
 * Serving Flask app 'Chat_bot'
 * Debug mode: on
 * Running on http://127.0.0.1:5000
```

### 3. ブラウザでアクセス

ブラウザを開いて以下のURLにアクセスしてください：

```
http://127.0.0.1:5000
```

## 使用方法

1. **場面を選択**: 画面左側のドロップダウンメニューから「第4コマ」「第7コマ」「第17コマ」いずれかを選択
2. **質問を入力**: テキスト入力欄に質問を入力
3. **送信**: 「送信」ボタンをクリック（またはEnterキーを押す）
4. **応答を確認**: チャット形式でシステムからの応答が表示されます

## 対応場面と質問例

### 第4コマ

- 「第4コマではどのような場面が描かれていますか？」
- 「主人公の僧侶は何をしていますか？」
- 「この場面の背景にはどのような建造物が見えますか？」

### 第7コマ

- 「第7コマではどのような出来事が起きていますか？」
- 「運ばれている荷物は何ですか？」
- 「この場面では何匹の鬼が登場していますか？」

### 第17コマ

- 「第17コマはどのような場面ですか？」
- 「この場面での人物の行動は何ですか？」
- 「背景に見える景色は何ですか？」

## システムの特性

- **完全一致方式**: 入力された質問が登録されている質問と完全に一致した場合のみ応答します
- **正規化処理**: 前後の空白と改行は自動的に削除されます
- **定型応答**: 対応していない質問には「申し訳ありません。この質問には現在対応していません。」と返答します
- **場面切り替え**: 場面を変更すると対話履歴が自動的にリセットされます

## ファイル構成

```
Mirubun/
├── Chat_bot.py           # メインアプリケーションファイル
├── requirements.txt      # 依存パッケージ一覧
├── README.md             # このファイル
└── templates/
    └── index.html        # Webインターフェース
```

## 技術仕様

### バックエンド
- **フレームワーク**: Flask
- **言語**: Python 3.8+
- **アーキテクチャ**: REST API（JSONベース）

### フロントエンド
- **言語**: HTML5 + CSS3 + JavaScript（ES6+）
- **特徴**: レスポンシブデザイン、モバイル対応

### データ管理
- 場面情報と質問・応答はPython内の辞書構造で管理
- サーバーサイドで状態管理（現在の場面ID、対話履歴）

## エラーハンドリング

- **場面未選択時**: 質問送信ボタンは無効化
- **空文字入力**: 何も処理されません
- **予期しない入力**: システムは停止せず、定型文を返答
- **サーバーエラー**: ユーザーへ適切なエラーメッセージを表示

## 非実装機能（仕様通り）

- 自然言語理解
- 文脈を跨いだ対話
- 自動場面判定
- 画像解析
- 外部API連携
- AI生成の応答

## 参考資料

- [国立国会図書館デジタルコレクション - 信貴山縁起絵巻](https://dl.ndl.go.jp/pid/2574276)

## ライセンス

このアプリケーションは教育用の学習用途を想定しています。
参照作品は国立国会図書館による公開資料であり、その著作権は国立国会図書館に帰属します。

## トラブルシューティング

### ポート5000が既に使用されている場合

`Chat_bot.py`の最後の行を以下のように変更してください：

```python
app.run(debug=True, host="127.0.0.1", port=5001)  # 5001に変更
```

その後、ブラウザで `http://127.0.0.1:5001` にアクセスしてください。

### Flaskがインストールされていない場合

再度以下のコマンドを実行してください：

```bash
pip install Flask==3.0.0
```

---

これらのコードやこの説明文は、生成AIを使用して制作しました。
質問文などに関しては、これから修正していく予定です。
