# 信貴山縁起絵巻 鑑賞支援システム

国立国会図書館デジタルコレクションで公開されている『信貴山縁起絵巻』を鑑賞する初学者向けの質問入力型Webアプリケーションです。

## 特徴

- **シンプルな設計**: 質問と応答のみに特化
- **ローカル環境で完結**: 外部API不要、オフライン環境で動作可能
- **3場面対応**: [1]第6-8コマ、[1]第17-20コマ、[3]第20-21コマ
- **チャット形式UI**: 直感的で使いやすいインターフェース
- **類似度マッチング**: TF-IDF（文字n-gram）+ コサイン類似度で近い質問を回答

## 動作環境

- Python 3.8以上
- Windows/Mac/Linux
- Webブラウザ（Chrome、Firefox、Safari、Edge など）

## インストール・実行手順

### 1. 依存パッケージのインストール

```bash
pip install -r requirements.txt
```

### 2. アプリケーションの実行

```bash
python Chat_bot.py
```

実行すると以下のメッセージが表示されます：

```
 * Serving Flask app 'Chat_bot'
 * Debug mode: on
 * Running on http://127.0.0.1:5000
```

### 3. ブラウザでアクセス

ブラウザを開いて以下のURLにアクセスしてください：

```
http://127.0.0.1:5000
```

## 使用方法

1. **場面を選択**: 画面左側のドロップダウンメニューから「第7コマ」「第17コマ」「第20コマ」など鑑賞したい場面を選択
2. **質問を入力**: テキスト入力欄に自由に質問を入力
3. **送信**: 「送信」ボタンをクリック
4. **応答を確認**: チャット形式でシステムからの応答が表示されます

## 対応場面と質問例

### [1]第6-8コマ

- 「この場面では一体何が起きているのですか？」
- 「なぜ蔵が空を飛んでいるのでしょうか？」
- 「このシーンの見どころは何ですか？」

### [1]第17-20コマ

- 「ここはどこで、何が起きているのですか？」
- 「右側に立っている数珠を持った人物は誰ですか？」
- 「鉢の上に乗っている米俵と、そこにいる人は何をしているのですか？」
- 「画面全体の構成で注目すべきポイントは何ですか？」

### [3]第20-21コマ

- 「この巨大な像は何ですか？」
- 「下の方にいる小さな人物は誰ですか？」
- 「この後、彼女はどうやって弟を見つけるのですか？」
- 「同じ姿の人が複数描かれているのは何故ですか？」

## システムの特性

- **自由入力 + 類似度マッチング**: 用意された質問に近い内容を自動で見つけて回答します
- **自動回答**: 入力された質問に対する回答が即座に表示されます
- **対話履歴**: チャット形式で質問と回答の履歴が保持されます
- **場面切り替え**: 場面を変更すると対話履歴が自動的にリセットされます

## ファイル構成

```
Mirubun/
├── Chat_bot.py           # メインアプリケーションファイル
├── requirements.txt      # 依存パッケージ一覧
├── README.md             # このファイル
└── templates/
    └── index.html        # Webインターフェース
```

## 技術仕様

### バックエンド
- **フレームワーク**: Flask
- **言語**: Python 3.8+
- **アーキテクチャ**: REST API（JSONベース）

### フロントエンド
- **言語**: HTML5 + CSS3 + JavaScript（ES6+）
- **特徴**: レスポンシブデザイン、モバイル対応

### データ管理
- 場面情報と質問・応答はPython内の辞書構造で管理
- 質問はTF-IDFでベクトル化し、コサイン類似度で照合
- サーバーサイドで状態管理（現在の場面ID、対話履歴）

## エラーハンドリング

- **場面未選択時**: 質問送信ボタンは無効化
- **空文字入力**: 何も処理されません
- **類似度が低い入力**: 定型文を返答
- **サーバーエラー**: ユーザーへ適切なエラーメッセージを表示

## 非実装機能（仕様通り）

- 自然言語理解
- 文脈を跨いだ対話
- 自動場面判定
- 画像解析
- 外部API連携
- AI生成の応答

## 参考資料

- [国立国会図書館デジタルコレクション - 信貴山縁起絵巻](https://dl.ndl.go.jp/pid/2574276)

## ライセンス

このアプリケーションは教育用の学習用途を想定しています。
参照作品は国立国会図書館による公開資料であり、その著作権は国立国会図書館に帰属します。

## トラブルシューティング

### ポート5000が既に使用されている場合

`Chat_bot.py`の最後の行を以下のように変更してください：

```python
app.run(debug=True, host="127.0.0.1", port=5001)  # 5001に変更
```

その後、ブラウザで `http://127.0.0.1:5001` にアクセスしてください。

### Flaskがインストールされていない場合

再度以下のコマンドを実行してください：

```bash
pip install Flask==3.0.0
```

---

これらのコードやこの説明文は、生成AIを使用して制作しました。
現在のコードはプロトタイプです。完成系としては、ユーザが自由に質問文を投げかけ、それに対して生成AIが自動で返答するシステムをイメージしています。
